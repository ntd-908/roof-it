!function(e){function t(t,n){var o,a=n||{},i=e(t),l=this,s=n.largeWrapper||".magnifier-preview",r=e(s),u=null,m={x:0,y:0,w:0,h:0,lensW:0,lensH:0,lensBgX:0,lensBgY:0,largeW:0,largeH:0,largeL:0,largeT:0,zoom:2,zoomMin:1.1,zoomMax:5,mode:"outside",eventType:"click",status:0,zoomAttached:!1,zoomable:void 0!==a.zoomable&&a.zoomable,onthumbenter:void 0!==a.onthumbenter?a.onthumbenter:null,onthumbmove:void 0!==a.onthumbmove?a.onthumbmove:null,onthumbleave:void 0!==a.onthumbleave?a.onthumbleave:null,onzoom:void 0!==a.onzoom?a.onzoom:null},h={t:0,l:0,x:0,y:0},d=0,g=0,f="",c=null,p=null,v=void 0===a.bg||a.lensbg,b=void 0!==a.zoom?a.zoom:m.zoom,y=void 0!==a.zoomMin?a.zoomMin:m.zoomMin,z=void 0!==a.zoomMax?a.zoomMax:m.zoomMax,x=a.mode||m.mode,M=a.eventType||m.eventType,w={},W=!1,H=!1,C=0,B=0,I=!0,T=!0,L="magnify-hidden",k="magnify-opaque";function N(e){if("string"==typeof e){if("true"===e)return!0;if("false"===e)return!1;console.warn("Wrong type: can't be transformed to Boolean")}else if("boolean"==typeof e)return e}function X(t,n,a,l){var s,r=i.find(".magnify-lens");1===w[t].status?(s=e('<div class="magnifier-loader-text"></div>'),r.className="magnifier-loader magnify-hidden",s.html("Loading..."),r.html("").append(s)):2===w[t].status&&(r.addClass(L),r.html(""),a.id=t+"-large",a.style.width=w[t].largeImgInMagnifyLensWidth+"px",a.style.height=w[t].largeImgInMagnifyLensHeight+"px",a.className="magnifier-large magnify-hidden","inside"===w[t].mode?r.append(a):l.html("").append(a)),w[t].lensH=w[t].lensH>o.height()?o.height():w[t].lensH,0===Math.round(w[t].lensW)?r.css("display","none"):r.css({width:Math.round(w[t].lensW)+"px",height:Math.round(w[t].lensH)+"px",display:""})}function Y(){var e,t,n=h.x-m.x,o=h.y-m.y;W=!(n<0||o<0||n>m.w||o>m.h),t=n-m.lensW/2,e=o-m.lensH/2,n<m.lensW/2&&(t=0),o<m.lensH/2&&(e=0),n-m.w+Math.ceil(m.lensW/2)>0&&(t=m.w-Math.ceil(m.lensW+2)),o-m.h+Math.ceil(m.lensH/2)>0&&(e=m.h-Math.ceil(m.lensH)),h.l=t,h.t=e,m.lensBgX=h.l,m.lensBgY=h.t,"inside"===m.mode?(m.largeL=Math.round(n*(m.zoom-m.lensW/m.w)),m.largeT=Math.round(o*(m.zoom-m.lensH/m.h))):(m.largeL=Math.round(m.lensBgX*m.zoom*(m.largeWrapperW/m.w)),m.largeT=Math.round(m.lensBgY*m.zoom*(m.largeWrapperH/m.h)))}function A(){N(I)&&(m=w[f],c=i.find(".magnify-lens"),2===m.status?(c.removeClass(k),(p=e("#"+f+"-large")).removeClass(L)):1===m.status&&(c.className="magnifier-loader"))}function q(){if(m.status>0){var e=m.onthumbleave;null!==e&&e({thumb:u,lens:c,large:p,x:h.x,y:h.y}),c.hasClass(L)||(c.addClass(L),null!==p&&p.addClass(L))}}function U(){if(N(I)){if(g!==m.status&&A(),m.status>0){u.className=m.thumbCssClass+" magnify-opaque",1===m.status?c.className="magnifier-loader":2===m.status&&(c.removeClass(L),p.removeClass(L),p.css({left:"-"+m.largeL+"px",top:"-"+m.largeT+"px"}));h.t=h.t<=0?0:h.t-2,c.css({left:h.l+C+"px",top:h.t+B+"px"}),v?c.css({"background-color":"rgba(f,f,f,.5)"}):c.get(0).style.backgroundPosition="-"+m.lensBgX+"px -"+m.lensBgY+"px";var e=m.onthumbmove;null!==e&&e({thumb:u,lens:c,large:p,x:h.x,y:h.y})}g=m.status}}function j(e,t){var n=e.getBoundingClientRect(),o=0,a=0;t.x=Math.round(n.left),t.y=Math.round(n.top),t.w=Math.round(n.right-t.x),t.h=Math.round(n.bottom-t.y),"inside"===t.mode?(o=t.w,a=t.h):(o=t.largeWrapperW,a=t.largeWrapperH),t.largeImgInMagnifyLensWidth=Math.round(t.zoom*o),t.largeImgInMagnifyLensHeight=Math.round(t.zoom*a),t.lensW=Math.round(t.w/t.zoom),t.lensH=Math.round(t.h/t.zoom)}function E(t,n){var i={};if(void 0===n.thumb)return!1;if((o=t.find(n.thumb)).length){for(var s in n)i[s]=n[s];i.thumb=o,N(I=i.enabled)?(r.show().css("display",""),r.addClass(L),function(t){if(void 0!==w[t.thumb.id])return u=t.thumb,!1;var n,o=new Image,i=new Image,l=t.thumb,s=l.get(0),r=s.id,h=e(t.largeWrapper),g=t.zoom||s.getAttribute("data-zoom")||b,f=t.zoomMin||y,c=t.zoomMax||z,p=t.mode||s.getAttribute("data-mode")||x,v=t.eventType||s.getAttribute("data-eventType")||M,I=void 0!==t.onthumbenter?t.onthumbenter:m.onthumbenter,L=void 0!==t.onthumbleave?t.onthumbleave:m.onthumbleave,k=void 0!==t.onthumbmove?t.onthumbmove:m.onthumbmove;n=l.data("original")||a.full||l.attr("src"),""===s.id&&(r=s.id="magnifier-item-"+d,d+=1);(function(t){if(e(t).siblings(".magnify-lens").length)return!1;var n=e('<div class="magnify-lens magnify-hidden" data-gallery-role="magnifier-zoom"></div>');e(t).parent().append(n)})(s),t.width&&h.width(t.width);t.height&&h.height(t.height);if(t.top){if("function"==typeof t.top)var N=t.top()+"px";else N=t.top+"px";h.length&&(h[0].style.top=N.replace("%px","%"))}if(t.left){if("function"==typeof t.left)var Y=t.left()+"px";else Y=t.left+"px";h.length&&(h[0].style.left=Y.replace("%px","%"))}w[r]={zoom:g,zoomMin:f,zoomMax:c,mode:p,eventType:v,thumbCssClass:s.className,zoomAttached:!1,status:0,largeUrl:n,largeWrapperId:"outside"===p?h.attr("id"):null,largeWrapperW:"outside"===p?h.width():null,largeWrapperH:"outside"===p?h.height():null,onthumbenter:I,onthumbleave:L,onthumbmove:k},C=(l.parent().width()-l.width())/2,B=(l.parent().height()-l.height())/2,T=!1,e(o).on("load",(function(){void 0!==w[r]&&(w[r].status=1,e(i).on("load",(function(){(i.width>h.width()||i.height>h.height())&&(T=!0,function(t,n){var o="hasBoundEvent_"+t;if(n[o])return;switch(n[o]=!0,t){case"hover":!function(t){e(t).on("mouseover",(function(e){T&&(0!==m.status&&q(),P(e),H=W)})).trigger("mouseover")}(n);break;case"click":!function(t){e(t).on("click",(function(e){T&&(H||(0!==m.status&&q(),P(e),H=!0))}))}(n)}}(v,s),w[r].status=2,i.width>i.height?w[r].zoom=i.width/h.width():w[r].zoom=i.height/h.height(),j(s,w[r]),X(r,0,i,h))})),i.src=w[r].largeUrl)})),o.src=s.src}(i)):r.empty().hide()}return l}function P(e){var t=e.target;f=t.id,u=t,A(),j(u,m),h.x=e.clientX,h.y=e.clientY,Y(),U();var n=m.onthumbenter;null!==n&&n({thumb:u,lens:c,large:p,x:h.x,y:h.y})}l.update=function(){X()},l.init=function(){E(i,n)},e(window).on("scroll",(function(){null!==u&&j(u,m)})),e(window).on("resize",(function(){E(i,a)})),i.on("mousemove",(function(e){h.x=e.clientX,h.y=e.clientY,Y(),"hover"===M&&(H=W),W&&H&&("outside"===x&&r.removeClass(L),U())})),i.on("mouseleave",(function(){q(),H=!1,r.addClass(L)})),E(i,a)}e.fn.magnify=function(n){"use strict";return new t(e(this),n)}}(jQuery);
